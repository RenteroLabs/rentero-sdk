!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("graphql-request"),require("ethers")):"function"==typeof define&&define.amd?define(["exports","graphql-request","ethers"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).rentero={},e.graphqlRequest,e.ethers)}(this,(function(e,n,t){"use strict";function a(e,n,t,a){return new(t||(t=Promise))((function(s,i){function r(e){try{p(a.next(e))}catch(e){i(e)}}function d(e){try{p(a.throw(e))}catch(e){i(e)}}function p(e){var n;e.done?s(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,d)}p((a=a.apply(e,n||[])).next())}))}function s(e,n,t,a){if("a"===t&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof n?e!==n||!a:!n.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?a:"a"===t?a.call(e):a?a.value:n.get(e)}function i(e,n,t,a,s){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof n?e!==n||!s:!n.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?s.call(e,t):s?s.value=t:n.set(e,t),t}const r={mainnet:"",rinkeby:"https://rinkeby.rentero.io/subgraphs/name/john-rentero/rentero-market",bsc:"",bsctestnet:"https://bsc-testnet.rentero.io/subgraphs/name/john-rentero/rentero-market"},d={"mainnet-installment":"","rinkeby-installment":"0x48430954949396E18ADeBb292e60D1B84782D6bD","bsc-installment":"","bsctestnet-installment":"0x4912C81659d6929B180AA828d4FBC58290C78833"},p=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftAddress",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"address",name:"lender",type:"address"},{indexed:!0,internalType:"address",name:"renter",type:"address"}],name:"Abort",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftAddress",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"lender",type:"address"},{indexed:!1,internalType:"address",name:"renter",type:"address"}],name:"ForceReclaim",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftAddress",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"address",name:"lender",type:"address"},{indexed:!0,internalType:"address",name:"renter",type:"address"}],name:"InstallmentFailed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftAddress",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"address",name:"lender",type:"address"},{indexed:!0,internalType:"address",name:"renter",type:"address"},{indexed:!1,internalType:"uint256",name:"paidExpires",type:"uint256"}],name:"InstallmentSuccess",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftAddress",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"lender",type:"address"}],name:"Lend",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftAddress",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"lender",type:"address"}],name:"ReLend",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftAddress",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"lender",type:"address"}],name:"Reclaim",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftAddress",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"address",name:"lender",type:"address"},{indexed:!0,internalType:"address",name:"renter",type:"address"},{indexed:!1,internalType:"uint256",name:"paidExpires",type:"uint256"},{indexed:!1,internalType:"uint256",name:"expires",type:"uint256"}],name:"Rent",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftAddress",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"renter",type:"address"},{indexed:!1,internalType:"uint256",name:"deposit",type:"uint256"}],name:"ReturnDeposit",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Unpaused",type:"event"},{inputs:[{internalType:"address",name:"nftAddress",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"abort",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"feeRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"feeReceiver",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"nftAddresses",type:"address[]"},{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"}],name:"installment",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"nftAddress",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"lease",outputs:[{internalType:"address",name:"lender",type:"address"},{internalType:"address",name:"erc20Address",type:"address"},{internalType:"address",name:"whitelist",type:"address"},{internalType:"uint256",name:"deposit",type:"uint256"},{internalType:"uint256",name:"rentPerDay",type:"uint256"},{internalType:"uint256",name:"daysPerPeriod",type:"uint256"},{internalType:"uint256",name:"minRentalDays",type:"uint256"},{internalType:"uint256",name:"maxRentalDays",type:"uint256"},{internalType:"address",name:"renter",type:"address"},{internalType:"uint256",name:"paidExpires",type:"uint256"},{internalType:"uint256",name:"expires",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"nftAddress",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"erc20Address",type:"address"},{internalType:"address",name:"whitelist",type:"address"},{internalType:"uint256",name:"deposit",type:"uint256"},{internalType:"uint256",name:"rentPerDay",type:"uint256"},{internalType:"uint16",name:"daysPerPeriod",type:"uint16"},{internalType:"uint16",name:"minRentalDays",type:"uint16"},{internalType:"uint16",name:"maxRentalDays",type:"uint16"}],name:"lend",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"monitor",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"nftAddressToRenteroAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"nftAddress",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"erc20Address",type:"address"},{internalType:"address",name:"whitelist",type:"address"},{internalType:"uint256",name:"deposit",type:"uint256"},{internalType:"uint256",name:"rentPerDay",type:"uint256"},{internalType:"uint16",name:"daysPerPeriod",type:"uint16"},{internalType:"uint16",name:"minRentalDays",type:"uint16"},{internalType:"uint16",name:"maxRentalDays",type:"uint16"}],name:"reLend",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"nftAddress",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"reclaim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"nftAddress",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint16",name:"rentalDays",type:"uint16"}],name:"rent",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"feeRate_",type:"uint256"}],name:"setFeeRate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"feeReceiver_",type:"address"}],name:"setFeeReceiver",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"monitor_",type:"address"}],name:"setMonitor",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"nftAddress",type:"address"},{internalType:"address",name:"renteroAddress",type:"address"}],name:"setRenteroAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unpause",outputs:[],stateMutability:"nonpayable",type:"function"}];var y,u,o,l,m;y=new WeakMap,u=new WeakMap;o=new WeakMap,l=new WeakMap,m=new WeakMap,e.Rentero=class{constructor(e,n){let a;o.set(this,void 0),l.set(this,void 0),m.set(this,void 0),i(this,l,n.renteroType,"f"),i(this,m,n.targetChain,"f"),a=n.marketAddress?n.marketAddress:d[[s(this,m,"f"),s(this,l,"f")].join("-")],i(this,o,new t.ethers.Contract(a,p,e),"f")}lendNFT(e,n,t,i,r,d,p,y,u){return a(this,void 0,void 0,(function*(){try{const a=yield s(this,o,"f").lend(e,n,t,i,r,d,p,y,u);return yield a.wait()}catch(e){return(null==e?void 0:e.error)||e}}))}reLendNFT(e,n,t,i,r,d,p,y,u){return a(this,void 0,void 0,(function*(){try{const a=yield s(this,o,"f").reLend(e,n,t,i,r,d,p,y,u);return yield a.wait()}catch(e){return(null==e?void 0:e.error)||e}}))}rentNFT(e,n,t){return a(this,void 0,void 0,(function*(){try{const a=yield s(this,o,"f").rent(e,n,t);return yield a.wait()}catch(e){return(null==e?void 0:e.error)||e}}))}earlyReturn(e,n){return a(this,void 0,void 0,(function*(){try{const t=yield s(this,o,"f").abort(e,n);return yield t.wait()}catch(e){return(null==e?void 0:e.error)||e}}))}redeemNFT(e,n){return a(this,void 0,void 0,(function*(){try{const t=yield s(this,o,"f").reclaim(e,n);return yield t.wait()}catch(e){return(null==e?void 0:e.error)||e}}))}},e.RenteroNFT=class{constructor(e,n){y.set(this,void 0),u.set(this,void 0),i(this,y,n.map((e=>e.toLowerCase())),"f"),i(this,u,r[e],"f")}getRentNFTsByAddress(e){return a(this,void 0,void 0,(function*(){const t=((new Date).getTime()/1e3).toFixed(),a=n.gql`
      query getRentNFTs($renter: String!, $contracts: [String!], $timestamp: String!) {
        leases(where: { 
          renter: $renter, 
          nftAddress_in: $contracts, 
          expires_gt: $timestamp ,
          }) {
            chain
            daysPerPeriod
            deposit
            erc20Address
            expires
            id
            lender
            maxRentalDays
            minRentalDays
            nftAddress
            paidExpires
            rentPerDay
            renter
            start
            tokenId
            whitelist
        }
      }
    `,i={renter:e.toLowerCase(),contracts:s(this,y,"f"),timestamp:t};return yield n.request(s(this,u,"f"),a,i)}))}getRentInfoById(e,t){return a(this,void 0,void 0,(function*(){const a=n.gql`
      query getRenterAddress($id: String!) {
        lease(id: $id) {
          chain
          daysPerPeriod
          deposit
          erc20Address
          expires
          id
          lender
          maxRentalDays
          minRentalDays
          nftAddress
          paidExpires
          rentPerDay
          renter
          start
          tokenId
          whitelist
        }
      }
    `,i={id:[e.toLowerCase(),t].join("-")};return yield n.request(s(this,u,"f"),a,i)}))}getLendNFTsByAddress(e){return a(this,void 0,void 0,(function*(){const t=n.gql`
      query getLendNFTs($lender: String!, $contracts: [String!]) {
        leases(where: {
          lender: $lender, 
          nftAddress_in: $contracts, 
        }) {
          chain
          daysPerPeriod
          deposit
          erc20Address
          expires
          id
          lender
          maxRentalDays
          minRentalDays
          nftAddress
          paidExpires
          rentPerDay
          renter
          start
          tokenId
          whitelist
        }
      }
    `,a={lender:e.toLowerCase(),contracts:s(this,y,"f")};return yield n.request(s(this,u,"f"),t,a)}))}getAllNFTsInMarket(){return a(this,void 0,void 0,(function*(){const e=n.gql`
      query getNFTs($contracts: [String!]) {
        leases(where: {nftAddress_in: $contracts}) {
          chain
          daysPerPeriod
          deposit
          erc20Address
          expires
          id
          lender
          maxRentalDays
          minRentalDays
          nftAddress
          paidExpires
          rentPerDay
          renter
          start
          tokenId
          whitelist 
        }
      }
    `,t={contracts:s(this,y,"f")};return yield n.request(s(this,u,"f"),e,t)}))}},Object.defineProperty(e,"__esModule",{value:!0})}));
